# Описание
Проект YaMDb представляет собой API, который собирает отзывы пользователей на произведения. Сами произведения в YaMDb не хранятся, здесь нельзя посмотреть фильм или послушать музыку. Произведения делятся на категории, такие как «Книги», «Фильмы», «Музыка». Произведению может быть присвоен жанр из списка предустановленных (например, «Сказка», «Рок» или «Артхаус»). Добавлять произведения, категории и жанры может только администратор.
Благодарные или возмущённые пользователи оставляют к произведениям текстовые отзывы и ставят произведению оценку в диапазоне от одного до десяти (целое число); из пользовательских оценок формируется усреднённая оценка произведения — рейтинг (целое число). На одно произведение пользователь может оставить только один отзыв.
Пользователи могут оставлять комментарии к отзывам.
Добавлять отзывы, комментарии и ставить оценки могут только аутентифицированные пользователи.

# Алгоритм регистрации пользователей
1. Пользователь отправляет POST-запрос на добавление нового пользователя с параметрами email и username на эндпоинт /api/v1/auth/signup/.
YaMDB отправляет письмо с кодом подтверждения (confirmation_code) на адрес email.
2. Пользователь отправляет POST-запрос с параметрами username и confirmation_code на эндпоинт /api/v1/auth/token/, в ответе на запрос ему приходит token (JWT-токен).
3. При желании пользователь отправляет PATCH-запрос на эндпоинт /api/v1/users/me/ и заполняет поля в своём профайле (описание полей — в документации).
# Пользовательские роли
Аноним — может просматривать описания произведений, читать отзывы и комментарии.
Аутентифицированный пользователь (user) — может, как и Аноним, читать всё, дополнительно он может публиковать отзывы и ставить оценку произведениям (фильмам/книгам/песенкам), может комментировать чужие отзывы; может редактировать и удалять свои отзывы и комментарии. Эта роль присваивается по умолчанию каждому новому пользователю.
Модератор (moderator) — те же права, что и у Аутентифицированного пользователя плюс право удалять любые отзывы и комментарии.
Администратор (admin) — полные права на управление всем контентом проекта. Может создавать и удалять произведения, категории и жанры. Может назначать роли пользователям.
Суперюзер Django — обладет правами администратора (admin)

# Установка
Как запустить проект:
### 1. Клонировать репозиторий и перейти в него в командной строке:
```git bash
git clone https://github.com/Scorcer777/api_yamdb/edit/
cd api_yamdb
```
### 2. Cоздать и активировать виртуальное окружение:
```bash
python3 -m venv env
source venv/Scripts/activate
```
### 3.Установить зависимости из файла requirements.txt:
```bash
python3 -m pip install --upgrade pip
pip install -r requirements.txt
```
Выполнить миграции:
```bash
python3 manage.py migrate
```
Опциональлно можно также импортировать в базу данные, подготовленные для демонстрации работы API:
```bash
python3 manage.py import
```
### 4. Запустить проект:
```bash
python3 manage.py runserver
```
# Примеры запросов
## 1. Регистрация пользователя и получение токена.
Для регистрации в системе и получения confirmation code необходимо отправить POST-запрос на URL-адрес `http://127.0.0.1:8000/api/v1/auth/signup/` с почтовым адресом и именем пользователя в формате JSON:
```
{
"email": "user@example.com",
"username": "string"
}
```
Ответ со статусом 200_OK придет в виде:
```
{
"email": "user@example.com",
"username": "string"
}
```

На указанный адрес email будет отправлен `confirmation_code`, который необходимо отправить со следующим POST-запросом на URL- адрес `http://127.0.0.1:8000/api/v1/auth/token/` для получения токена:
```
{
"username": "string",
"confirmation_code": "string"
}
```
Ответ с токеном и статусом 200_OK придет в виде:
```
{
"token": "string"
}
```
Для выполнения ряда действий с API, таких как размещение отзыва к произведению или комментария к отзыву, требуется аутентификация. Для аутентификации при отправке запроса необходимо в заголовке запроса Authorization отправить значение вида: `Bearer <номер_токена>`.

## 2. Запросы на получение информации не требующие аутентификации.
- Отправить GET-запрос URL `http://127.0.0.1:8000/api/v1/titles/` - **получение списка произведений**
    - Возможна фильтрация посредством указания параметров `genre` и(или) `category` при отправке запроса, пример: `http://127.0.0.1:8000/api/v1/titles/?genre=Драма&category=Фильм`
- Отправить GET-запрос URL `http://127.0.0.1:8000/api/v1/titles/{title_id}/` - **получение одного произведения**.
- Отправить GET-запрос URL `http://127.0.0.1:8000/api/v1/genres/` -- **получение списка жанров произведений**
    - Возможен поиск посредством указания параметра `search` при отправке запроса, пример: `http://127.0.0.1:8000/api/v1/genres/?search=Драма`
- Отправить GET-запрос URL `http://127.0.0.1:8000/api/v1/categories/` -- **получение списка категорий произведений**
    - Возможен поиск посредством указания параметра `search` при отправке запроса, пример: `http://127.0.0.1:8000/api/v1/categories/?search=Фильм`
- Отправить GET-запрос URL `http://127.0.0.1:8000/api/v1/titles/{title_id}/reviews/` - **получение списка отзывов к указанному произведению**;
- Отправить GET-запрос URL `http://127.0.0.1:8000/api/v1/titles/{title_id}/reviews/{review_id}/` - **получение одного отзывова к указанному произведению**;
- Отправить GET-запрос URL `http://127.0.0.1:8000/api/v1/titles/{title_id}/reviews/{review_id}/comments/` - **получение списка комментариев к указанным произведению и отзыву**;
- Отправить GET-запрос URL `http://127.0.0.1:8000/api/v1/titles/{title_id}/reviews/{review_id}/comments/{comment_id}/` - **получение одного комментария к указанным произведению и отзыву**.

### где {title_id}, {review_id}, {comment_id} - целые числа. 

Пример успешного ответа на запрос о получении списка произведений:
```
{
    "count": 2,
    "next": null,
    "previous": null,
    "results": [
        {
            "id": 1,
            "name": "Побег из Шоушенка",
            "year": 1994,
            "rating": 10,
            "description": "",
            "genre": [
                {
                    "name": "Драма",
                    "slug": "drama"
                }
            ],
            "category": {
                "name": "Фильм",
                "slug": "movie"
            }
        },
        {
            "id": 2,
            "name": "Крестный отец",
            "year": 1972,
            "rating": 4,
            "description": "",
            "genre": [
                {
                    "name": "Драма",
                    "slug": "drama"
                }
}
```
## 3. Запросы на получение, размещение, изменение или удаление информации требующие аутентификации.
- Отправить GET-запрос URL `http://127.0.0.1:8000/api/v1/users/me/` - **получение данных своей учетной записи**.
Пример успешного ответа, статус 200_ОК:
```
{
"username": "string",
"email": "user@example.com",
"first_name": "string",
"last_name": "string",
"bio": "string",
"role": "user"
}
```

- Отправить PATCH-запрос URL `http://127.0.0.1:8000/api/v1/users/me/` - **изменение данных своей учетной записи**(доступно только владельцу учетной записи).
Пример запроса:
```
{
"username": "string", (обязательное поле)
"email": "user@example.com", (обязательное поле)
"first_name": "string",
"last_name": "string",
"bio": "string"
}
```
Пример успешного ответа 200_OK:
```
{
"username": "string",
"email": "user@example.com",
"first_name": "string",
"last_name": "string",
"bio": "string",
"role": "user"
}
```

- Отправить POST-запрос URL `http://127.0.0.1:8000/api/v1/titles/{title_id}/reviews/` - **размещение отзыва к указанному произведению**.
Пример запроса:
```
{
"text": "string", (обязательное поле)
"score": 1 (обязательное поле, ввести значение от 1 до 10)
}
```
Пример успешного ответа, статус 201_CREATED:
```
{
"id": 0,
"text": "string",
"author": "string",
"score": 1,
"pub_date": "2019-08-24T14:15:22Z"
}
```

- Отправить PACTH или PUT-запрос URL `http://127.0.0.1:8000/api/v1/titles/{title_id}/reviews/{review_id}/` - **частичное или полное изменение отзыва к указанному произведению(доступно только автору отзыва)**.
Пример запроса:
```
{
"text": "string", (обязательное поле)
"score": 1 (обязательное поле, ввести значение от 1 до 10)
}
```
Пример успешного ответа, статус 201_CREATED:
```
{
"id": 0,
"text": "string",
"author": "string",
"score": 1,
"pub_date": "2019-08-24T14:15:22Z"
}
```

- Отправить DELETE-запрос URL `http://127.0.0.1:8000/api/v1/titles/{title_id}/reviews/{review_id}/` - **удаление отзыва к указанному произведению(доступно только автору отзыва)**.
Пример успешного ответа: статус 204_NO_CONTENT

- Отправить POST-запрос URL `http://127.0.0.1:8000/api/v1/titles/{title_id}/reviews/{review_id}/comments/` - **размещение комментария к указанным произведению и отзыву**.
Пример запроса:
```
{
"text": "string" (обязательное поле)
}
```
Пример успешного ответа, статус 201_CREATED:
```
{
"id": 0,
"text": "string",
"author": "string",
"pub_date": "2019-08-24T14:15:22Z"
}
```

- Отправить PACTH или PUT-запрос URL `http://127.0.0.1:8000/api/v1/titles/{title_id}/reviews/{review_id}/comments/{comment_id}/` - **частичное или полное изменение комментария к указанным произведению и отзыву(доступно только автору комментария)**.
Пример запроса:
```
{
"text": "string" (обязательное поле)
}
```
Пример успешного ответа, статус 201_CREATED:
```
{
"id": 0,
"text": "string",
"author": "string",
"pub_date": "2019-08-24T14:15:22Z"
}
```

- Отправить DELETE-запрос URL `http://127.0.0.1:8000/api/v1/titles/{title_id}/reviews/{review_id}/comments/{comment_id}/` -**удаление комментария к указанным произведению и отзыву(доступно только автору комментария)**.
Пример успешного ответа: статус 204_NO_CONTENT

## Документация с описанием всех эндпоинтов и запросов доспупна по URL-адресу:

`http://127.0.0.1:8000/redoc/`
Отркывать в браузере при запущенном локально сервере.
